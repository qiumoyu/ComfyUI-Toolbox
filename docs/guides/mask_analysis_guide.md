# 遮罩分析插件使用指南

## 概述

遮罩分析插件提供了强大的遮罩处理和分析功能，包括边缘检测、形状分析和基础工具操作。

## 节点列表

### 1. 遮罩边缘检测 (MaskEdgeDetection)

检测遮罩是否接触图像边缘，提供详细的分析报告和可视化结果。

#### 输入参数
- **mask**: 遮罩图像 (MASK)
- **threshold**: 二值化阈值 (0.0-1.0, 默认0.1)
- **edge_tolerance**: 边缘容差像素数 (0-10, 默认2)
- **image**: 可选的原图像，用于可视化 (IMAGE)

#### 输出结果
- **is_edge_touching**: 是否接触边缘 (BOOLEAN)
- **edge_info**: 边缘接触详细信息 (STRING)
- **visualization**: 可视化结果图像 (IMAGE)

#### 使用示例
1. 连接遮罩输入
2. 调整阈值参数（建议0.1-0.3）
3. 设置边缘容差（建议2-5像素）
4. 可选连接原图像用于更好的可视化
5. 运行工作流查看结果

### 2. 高级遮罩分析 (AdvancedMaskAnalysis)

提供多种分析模式：边缘检测、形状分析、连通性分析和综合分析。

#### 输入参数
- **mask**: 遮罩图像 (MASK)
- **threshold**: 二值化阈值 (0.0-1.0, 默认0.1)
- **analysis_type**: 分析类型选择
  - `edge_detection`: 边缘检测分析
  - `shape_analysis`: 形状特征分析
  - `connectivity`: 连通性分析
  - `all`: 综合分析
- **image**: 可选的原图像 (IMAGE)
- **min_area**: 最小区域面积 (1-10000, 默认100)

#### 输出结果
- **has_edge_contact**: 是否有边缘接触 (BOOLEAN)
- **analysis_report**: 详细分析报告 (STRING)
- **visualization**: 可视化结果 (IMAGE)
- **coverage_ratio**: 遮罩覆盖率 (FLOAT)
- **num_regions**: 连通区域数量 (INT)

#### 分析类型说明

##### 边缘检测分析
- 检测遮罩是否接触图像边缘
- 计算边缘像素比例
- 提供边缘接触的详细信息

##### 形状分析
- 计算每个连通区域的形状特征
- 包括面积、周长、圆度、长宽比等
- 支持最小区域面积过滤

##### 连通性分析
- 分析遮罩的连通区域
- 统计区域数量和面积分布
- 识别大型连通区域

##### 综合分析
- 结合所有分析类型
- 提供完整的遮罩分析报告

### 3. 遮罩工具 (MaskUtils)

提供遮罩的预处理和后处理功能。

#### 输入参数
- **mask**: 遮罩图像 (MASK)
- **operation**: 操作类型
  - `threshold`: 阈值处理
  - `morphology`: 形态学操作
  - `smooth`: 平滑处理
  - `resize`: 尺寸调整
  - `invert`: 反转操作
- **threshold**: 阈值 (0.0-1.0, 默认0.5)
- **kernel_size**: 核大小 (1-21, 默认3)
- **iterations**: 迭代次数 (1-10, 默认1)
- **target_size**: 目标尺寸 (字符串格式 "width,height")

#### 输出结果
- **processed_mask**: 处理后的遮罩 (MASK)
- **visualization**: 可视化结果 (IMAGE)

## 工作流示例

### 基础边缘检测工作流
1. 加载遮罩图像
2. 连接遮罩边缘检测节点
3. 调整参数
4. 查看结果

### 完整分析工作流
1. 加载遮罩和原图像
2. 使用遮罩工具进行预处理
3. 连接高级遮罩分析节点
4. 选择综合分析模式
5. 查看详细报告和可视化

## 参数调优建议

### 阈值设置
- **低阈值 (0.1-0.3)**: 适合噪声较少的遮罩
- **中等阈值 (0.3-0.7)**: 适合一般遮罩
- **高阈值 (0.7-0.9)**: 适合需要精确边界的遮罩

### 边缘容差
- **小容差 (1-2像素)**: 精确检测
- **中等容差 (3-5像素)**: 平衡精度和鲁棒性
- **大容差 (6-10像素)**: 宽松检测

### 最小区域面积
- **小面积 (10-100像素)**: 检测小区域
- **中等面积 (100-1000像素)**: 一般用途
- **大面积 (1000+像素)**: 过滤噪声

## 常见问题

### Q: 为什么检测不到边缘接触？
A: 检查阈值设置是否过高，边缘容差是否过小。

### Q: 如何提高分析精度？
A: 使用遮罩工具进行预处理，清理噪声和优化边界。

### Q: 可视化结果不清晰？
A: 连接原图像输入，调整透明度参数。

## 最佳实践

1. **预处理**: 使用遮罩工具清理噪声
2. **参数调优**: 根据具体遮罩特征调整参数
3. **多步分析**: 结合多种分析模式获得全面结果
4. **结果验证**: 通过可视化确认分析结果

## 扩展功能

插件支持自定义扩展，可以添加新的分析模式和工具功能。参考源代码结构进行开发。 